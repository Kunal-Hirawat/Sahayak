<!DOCTYPE html>\n<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>Cosmic Calculator: Mission to Neptune</title>\n    <link rel=\"preconnect\" href=\"https://fonts.googleapis.com\">\n    <link rel=\"preconnect\" href=\"https://fonts.gstatic.com\" crossorigin>\n    <link href=\"https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&family=Roboto:wght@400;700&display=swap\" rel=\"stylesheet\">\n    <style>\n        /* ------------------- */\n        /* --- GLOBAL CSS ---- */\n        /* ------------------- */\n        :root {\n            --space-blue: #0b0f3a;\n            --cosmic-purple: #4c2a85;\n            --neon-green: #39ff14;\n            --glow-yellow: #f8f32b;\n            --light-text: #f0f8ff;\n            --hologram-bg: rgba(20, 30, 80, 0.85);\n            --hologram-border: rgba(57, 255, 20, 0.7);\n        }\n\n        * {\n            box-sizing: border-box;\n            margin: 0;\n            padding: 0;\n        }\n\n        html, body {\n            width: 100%;\n            height: 100%;\n            overflow: hidden;\n            font-family: 'Roboto', sans-serif;\n        }\n\n        body {\n            background-color: var(--space-blue);\n            color: var(--light-text);\n            display: flex;\n            justify-content: center;\n            align-items: center;\n        }\n\n        /* ------------------- */\n        /* --- SVG ASSETS ---- */\n        /* ------------------- */\n        #svg-assets {\n            display: none;\n        }\n\n        /* ------------------- */\n        /* -- GAME CONTAINER - */\n        /* ------------------- */\n        #game-container {\n            width: 100%;\n            max-width: 1000px;\n            height: 100%;\n            max-height: 700px;\n            background: var(--space-blue) url('data:image/svg+xml,<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"100\" height=\"100\" viewBox=\"0 0 100 100\"><g fill=\"white\" fill-opacity=\"0.2\"><circle cx=\"20\" cy=\"20\" r=\"1\"/><circle cx=\"50\" cy=\"80\" r=\"1\"/><circle cx=\"80\" cy=\"30\" r=\"0.5\"/><circle cx=\"10\" cy=\"60\" r=\"0.5\"/><circle cx=\"90\" cy=\"90\" r=\"1\"/></g></svg>');\n            border: 3px solid var(--neon-green);\n            border-radius: 15px;\n            box-shadow: 0 0 25px var(--neon-green);\n            display: flex;\n            flex-direction: column;\n            position: relative;\n            overflow: hidden;\n            font-family: 'Orbitron', sans-serif;\n        }\n\n        .hidden {\n            display: none !important;\n        }\n\n        /* ------------------- */\n        /* --- GAME SCREENS -- */\n        /* ------------------- */\n        .game-screen {\n            position: absolute;\n            top: 0;\n            left: 0;\n            width: 100%;\n            height: 100%;\n            background: rgba(11, 15, 58, 0.9);\n            display: flex;\n            flex-direction: column;\n            justify-content: center;\n            align-items: center;\n            text-align: center;\n            z-index: 100;\n            padding: 20px;\n        }\n\n        .game-screen h1 {\n            font-size: 3rem;\n            color: var(--glow-yellow);\n            text-shadow: 0 0 10px var(--glow-yellow);\n            margin-bottom: 20px;\n        }\n        \n        #win-screen h1 {\n            animation: fireworks 2s infinite;\n        }\n\n        .game-screen p {\n            font-size: 1.2rem;\n            max-width: 600px;\n            margin-bottom: 30px;\n            font-family: 'Roboto', sans-serif;\n            line-height: 1.6;\n        }\n\n        .game-button {\n            padding: 15px 30px;\n            font-size: 1.5rem;\n            font-family: 'Orbitron', sans-serif;\n            background-color: var(--neon-green);\n            color: var(--space-blue);\n            border: none;\n            border-radius: 10px;\n            cursor: pointer;\n            text-transform: uppercase;\n            font-weight: 700;\n            box-shadow: 0 5px 0 #1a9a08;\n            transition: all 0.1s ease-in-out;\n        }\n\n        .game-button:hover {\n            background-color: #6cff57;\n        }\n\n        .game-button:active {\n            transform: translateY(5px);\n            box-shadow: 0 0 0 #1a9a08;\n        }\n\n        /* ------------------- */\n        /* -- PROGRESS BAR --- */\n        /* ------------------- */\n        #progress-bar {\n            width: 100%;\n            padding: 10px 20px;\n            display: flex;\n            justify-content: space-between;\n            align-items: center;\n            border-bottom: 2px solid var(--hologram-border);\n            background: rgba(0,0,0,0.2);\n        }\n\n        .planet-stop {\n            display: flex;\n            flex-direction: column;\n            align-items: center;\n            opacity: 0.5;\n            transition: opacity 0.5s;\n        }\n\n        .planet-stop.active {\n            opacity: 1;\n            transform: scale(1.1);\n        }\n\n        .planet-stop svg {\n            width: 40px;\n            height: 40px;\n        }\n\n        .planet-stop span {\n            font-size: 0.8rem;\n            margin-top: 5px;\n        }\n        \n        .progress-line {\n            flex-grow: 1;\n            height: 4px;\n            background-color: var(--hologram-border);\n            opacity: 0.5;\n            margin: 0 10px;\n            margin-bottom: 25px; /* align with planets */\n        }\n\n        /* ------------------- */\n        /* --- MAIN CANVAS --- */\n        /* ------------------- */\n        #main-canvas {\n            flex-grow: 1;\n            position: relative;\n            overflow: hidden;\n        }\n\n        #rocket {\n            position: absolute;\n            width: 100px;\n            height: auto;\n            transition: all 1.5s ease-in-out;\n            z-index: 10;\n        }\n\n        .planet-bg {\n            position: absolute;\n            opacity: 0;\n            transition: opacity 1s ease-in-out;\n            width: 300px;\n            height: 300px;\n            right: 5%;\n            top: 50%;\n            transform: translateY(-50%);\n        }\n        \n        .planet-bg.visible {\n            opacity: 1;\n        }\n\n        /* ------------------- */\n        /* --- UI PANELS ----- */\n        /* ------------------- */\n        #question-panel {\n            position: absolute;\n            top: 10%;\n            left: 50%;\n            transform: translateX(-50%);\n            width: 90%;\n            max-width: 500px;\n            background: var(--hologram-bg);\n            border: 2px solid var(--hologram-border);\n            border-radius: 10px;\n            padding: 20px 20px 20px 80px;\n            display: flex;\n            align-items: center;\n            box-shadow: 0 0 15px var(--hologram-border);\n            z-index: 20;\n            transition: opacity 0.5s;\n        }\n\n        #mascot {\n            position: absolute;\n            left: -30px;\n            bottom: -15px;\n            width: 100px;\n            height: auto;\n        }\n        \n        #question-text {\n            font-size: 1.1rem;\n            font-family: 'Roboto', sans-serif;\n            line-height: 1.5;\n        }\n        \n        #hint-box {\n            position: absolute;\n            bottom: 110%;\n            left: 70px;\n            background: var(--glow-yellow);\n            color: var(--space-blue);\n            padding: 10px;\n            border-radius: 8px;\n            font-size: 0.9rem;\n            font-weight: bold;\n            display: none; /* controlled by JS */\n        }\n        \n        #hint-box::after {\n            content: '';\n            position: absolute;\n            bottom: -10px;\n            left: 20px;\n            border-width: 10px 10px 0;\n            border-style: solid;\n            border-color: var(--glow-yellow) transparent;\n        }\n\n        /* ------------------- */\n        /* -- INTERACTION AREA - */\n        /* ------------------- */\n        #interaction-area {\n            width: 100%;\n            min-height: 150px;\n            background: rgba(0,0,0,0.3);\n            border-top: 2px solid var(--hologram-border);\n            padding: 20px;\n            display: flex;\n            justify-content: center;\n            align-items: center;\n            position: relative;\n        }\n\n        #submit-button {\n            position: absolute;\n            right: 20px;\n            bottom: 20px;\n            width: 100px;\n            height: 100px;\n            border-radius: 50%;\n            font-size: 1.2rem;\n            font-weight: 700;\n        }\n\n        /* Level 1: Fuel Cells */\n        #fuel-tray {\n            display: flex;\n            gap: 20px;\n        }\n        .fuel-pile {\n            padding: 10px;\n            border: 2px dashed var(--hologram-border);\n            border-radius: 10px;\n            cursor: grab;\n            display: flex;\n            flex-direction: column;\n            align-items: center;\n        }\n        .fuel-pile:active { cursor: grabbing; }\n        .fuel-pile svg {\n            width: 60px;\n            height: 60px;\n        }\n\n        /* Level 2: Keypad */\n        #keypad-container {\n            display: flex;\n            gap: 10px;\n            align-items: center;\n        }\n        #datapad-display {\n            width: 150px;\n            height: 60px;\n            background: #000;\n            border: 2px solid var(--hologram-border);\n            color: var(--neon-green);\n            font-size: 2.5rem;\n            text-align: right;\n            padding: 5px;\n        }\n        #keypad {\n            display: grid;\n            grid-template-columns: repeat(3, 1fr);\n            gap: 5px;\n        }\n        .keypad-btn {\n            width: 50px;\n            height: 50px;\n            font-size: 1.5rem;\n            background: #222;\n            color: var(--light-text);\n            border: 1px solid var(--hologram-border);\n            cursor: pointer;\n        }\n        .keypad-btn:hover { background: #444; }\n\n        /* Level 3: Division Choices */\n        #lab-container {\n            display: flex;\n            gap: 20px;\n            align-items: center;\n        }\n        .lab-box {\n            width: 100px;\n            height: 100px;\n            border: 3px solid var(--neon-green);\n            background: rgba(57, 255, 20, 0.1);\n            border-radius: 10px;\n            display: flex;\n            justify-content: center;\n            align-items: center;\n            font-size: 3rem;\n            color: var(--glow-yellow);\n        }\n        #answer-choices {\n            display: flex;\n            flex-direction: column;\n            gap: 10px;\n            margin-left: 30px;\n        }\n        .choice-btn {\n            width: 60px;\n            height: 60px;\n            border-radius: 50%;\n            font-size: 2rem;\n            background: var(--cosmic-purple);\n            border: 2px solid var(--glow-yellow);\n            color: var(--glow-yellow);\n            cursor: pointer;\n        }\n        .choice-btn.selected {\n            background: var(--glow-yellow);\n            color: var(--cosmic-purple);\n        }\n\n        /* ------------------- */\n        /* ---- ANIMATIONS --- */\n        /* ------------------- */\n        @keyframes shake {\n            0%, 100% { transform: translateX(0); }\n            10%, 30%, 50%, 70%, 90% { transform: translateX(-5px); }\n            20%, 40%, 60%, 80% { transform: translateX(5px); }\n        }\n        .shake {\n            animation: shake 0.5s;\n        }\n\n        @keyframes pulse {\n            0% { box-shadow: 0 0 10px var(--glow-yellow); }\n            50% { box-shadow: 0 0 25px var(--glow-yellow); }\n            100% { box-shadow: 0 0 10px var(--glow-yellow); }\n        }\n        .pulse {\n            animation: pulse 1.5s infinite;\n        }\n        \n        @keyframes fireworks {\n            0% { text-shadow: 0 0 10px #f8f32b, 0 0 20px #ff6b6b; }\n            25% { text-shadow: 0 0 15px #39ff14, 0 0 25px #4ecdc4; }\n            50% { text-shadow: 0 0 10px #f8f32b, 0 0 30px #f0f8ff; }\n            75% { text-shadow: 0 0 15px #ff6b6b, 0 0 25px #4c2a85; }\n            100% { text-shadow: 0 0 10px #f8f32b, 0 0 20px #ff6b6b; }\n        }\n\n        /* ------------------- */\n        /* --- RESPONSIVE ---- */\n        /* ------------------- */\n        @media (max-width: 768px) {\n            #game-container { max-height: none; border-radius: 0; border: none; }\n            .game-screen h1 { font-size: 2rem; }\n            .game-screen p { font-size: 1rem; }\n            #question-panel { top: 18%; padding: 15px 15px 15px 60px; }\n            #mascot { width: 80px; left: -20px; }\n            #question-text { font-size: 0.9rem; }\n            #interaction-area { flex-direction: column; gap: 15px; min-height: 250px; }\n            #submit-button { position: static; width: 150px; height: 60px; border-radius: 10px; }\n            #fuel-tray { gap: 10px; }\n            #fuel-pile svg { width: 40px; height: 40px; }\n            .planet-stop svg { width: 30px; height: 30px; }\n            .planet-stop span { font-size: 0.7rem; }\n            .progress-line { margin-bottom: 20px; }\n            #keypad-container { flex-direction: column; }\n            #lab-container { flex-direction: column; }\n        }\n\n    </style>\n</head>\n<body>\n\n    <!-- Hidden SVG assets for cloning -->\n    <div id=\"svg-assets\">\n        <svg id=\"svg-rocket\" viewBox=\"0 0 100 150\">\n            <g fill=\"#E0E0E0\">\n                <path d=\"M50 0 L70 40 L30 40 Z\" />\n                <rect x=\"30\" y=\"40\" width=\"40\" height=\"80\" rx=\"10\" />\n            </g>\n            <g fill=\"#B0B0B0\">\n                <path d=\"M30 120 L10 150 L30 130 Z\" />\n                <path d=\"M70 120 L90 150 L70 130 Z\" />\n            </g>\n            <circle cx=\"50\" cy=\"70\" r=\"15\" fill=\"#70A0D0\" stroke=\"white\" stroke-width=\"3\" />\n            <g fill=\"#FF6B6B\">\n                <path d=\"M50 120 Q30 140 20 160 L80 160 Q70 140 50 120 Z\" />\n            </g>\n        </svg>\n\n        <svg id=\"svg-bolt\" viewBox=\"0 0 100 100\">\n            <g fill=\"#A0A0A0\">\n                <circle cx=\"50\" cy=\"30\" r=\"25\"/>\n                <rect x=\"35\" y=\"55\" width=\"30\" height=\"35\" rx=\"5\"/>\n                <rect x=\"25\" y=\"60\" width=\"10\" height=\"20\" rx=\"5\" transform=\"rotate(-30 30 70)\"/>\n                <rect x=\"65\" y=\"60\" width=\"10\" height=\"20\" rx=\"5\" transform=\"rotate(30 70 70)\"/>\n            </g>\n            <circle cx=\"50\" cy=\"30\" r=\"18\" fill=\"#000\"/>\n            <circle cx=\"50\" cy=\"30\" r=\"15\" fill=\"#39ff14\"/>\n            <circle cx=\"50\" cy=\"30\" r=\"5\" fill=\"#000\"/>\n        </svg>\n\n        <svg id=\"svg-earth\" viewBox=\"0 0 100 100\">\n            <circle cx=\"50\" cy=\"50\" r=\"48\" fill=\"#4a90e2\"/>\n            <path d=\"M20 50 C 40 20, 60 30, 80 50 S 60 90, 40 80 S 20 70, 20 50\" fill=\"#50c878\"/>\n        </svg>\n\n        <svg id=\"svg-mars\" viewBox=\"0 0 100 100\">\n            <circle cx=\"50\" cy=\"50\" r=\"48\" fill=\"#d06020\"/>\n            <circle cx=\"30\" cy=\"30\" r=\"10\" fill=\"#a05020\"/>\n            <circle cx=\"70\" cy=\"60\" r=\"15\" fill=\"#a05020\"/>\n        </svg>\n\n        <svg id=\"svg-jupiter\" viewBox=\"0 0 100 100\">\n            <circle cx=\"50\" cy=\"50\" r=\"48\" fill=\"#e0c090\"/>\n            <path d=\"M10 30 C 40 25, 60 35, 90 40\" stroke=\"#c0a070\" stroke-width=\"8\" fill=\"none\"/>\n            <path d=\"M10 50 C 40 45, 60 55, 90 60\" stroke=\"#a08050\" stroke-width=\"10\" fill=\"none\"/>\n            <path d=\"M10 70 C 40 65, 60 75, 90 80\" stroke=\"#c0a070\" stroke-width=\"8\" fill=\"none\"/>\n        </svg>\n\n        <svg id=\"svg-neptune\" viewBox=\"0 0 100 100\">\n            <circle cx=\"50\" cy=\"50\" r=\"48\" fill=\"#3f51b5\"/>\n            <circle cx=\"50\" cy=\"50\" r=\"35\" stroke=\"#8c9eff\" stroke-width=\"5\" fill=\"none\" opacity=\"0.7\"/>\n        </svg>\n\n        <svg id=\"svg-fuel\" viewBox=\"0 0 100 100\">\n            <rect x=\"20\" y=\"10\" width=\"60\" height=\"80\" rx=\"10\" fill=\"#f8f32b\"/>\n            <rect x=\"30\" y=\"20\" width=\"40\" height=\"60\" fill=\"rgba(0,0,0,0.2)\"/>\n            <path d=\"M40 30 L60 30 L50 45 Z\" fill=\"#39ff14\"/>\n        </svg>\n    </div>\n\n    <!-- Main Game Container -->\n    <div id=\"game-container\">\n        <!-- Start Screen -->\n        <div id=\"start-screen\" class=\"game-screen\">\n            <h1>Cosmic Calculator</h1>\n            <p>Welcome, Commander! Your mission is to fly to Neptune. Solve math problems at each planet to collect Nav-Data and chart our course. Let's launch!</p>\n            <button id=\"start-button\" class=\"game-button\">Start Mission</button>\n        </div>\n\n        <!-- Win Screen -->\n        <div id=\"win-screen\" class=\"game-screen hidden\">\n            <h1>Mission Complete!</h1>\n            <p id=\"win-text\">You've successfully navigated to Neptune! What a stellar performance, Commander!</p>\n            <p id=\"final-score\"></p>\n            <button id=\"restart-button\" class=\"game-button\">Play Again</button>\n        </div>\n\n        <!-- Header: Progress Bar -->\n        <header id=\"progress-bar\">\n            <!-- Dynamically populated by JS -->\n        </header>\n\n        <!-- Main visual area -->\n        <main id=\"main-canvas\">\n            <div id=\"rocket\"></div>\n            <!-- Planets will be added here by JS -->\n        </main>\n\n        <!-- Question and Mascot Panel -->\n        <section id=\"question-panel\" class=\"hidden\">\n            <div id=\"mascot\"></div>\n            <div id=\"hint-box\">This is a hint!</div>\n            <p id=\"question-text\"></p>\n        </section>\n\n        <!-- Bottom interaction area -->\n        <footer id=\"interaction-area\">\n            <!-- Dynamically populated by JS -->\n        </footer>\n    </div>\n\n    <script>\n    document.addEventListener('DOMContentLoaded', () => {\n        //-------------------------------------//\n        //----------- GAME STATE & CONFIG -----------//\n        //-------------------------------------//\n\n        const gameState = {\n            currentLevel: 0,\n            score: 0,\n            attempts: 0,\n            levelData: [\n                { // Level 0: Earth\n                    planet: 'Earth',\n                    question: \"Commander, our rocket needs <strong>8</strong> fuel cells. Drag the correct number of fuel cells to the rocket's launchpad.\",\n                    answer: 8,\n                    interaction: 'drag-drop',\n                    hint: \"Count the fuel cells in each pile. Which pile has exactly 8?\",\n                    setup: setupLevel1,\n                    check: checkLevel1\n                },\n                { // Level 1: Mars\n                    planet: 'Mars',\n                    question: \"We're at Mars! It has 2 moons. Bolt needs 4 samples from <em>each</em> moon. How many samples is that in total?\",\n                    answer: 8,\n                    interaction: 'keypad',\n                    hint: \"Think '2 groups of 4'. You can use multiplication: 2 x 4.\",\n                    setup: setupLevel2,\n                    check: checkLevel2\n                },\n                { // Level 2: Jupiter\n                    planet: 'Jupiter',\n                    question: \"Wow, we collected <strong>15</strong> space gems! Let's share them equally among <strong>3</strong> science labs. How many gems does each lab get?\",\n                    answer: 5,\n                    interaction: 'choice',\n                    hint: \"This is division! What is 15 divided by 3?\",\n                    setup: setupLevel3,\n                    check: checkLevel3\n                }\n            ],\n            planetPositions: [\n                { name: 'Earth', left: '10%', top: '50%' },\n                { name: 'Mars', left: '35%', top: '50%' },\n                { name: 'Jupiter', left: '60%', top: '50%' },\n                { name: 'Neptune', left: '85%', top: '50%' }\n            ]\n        };\n\n        //-------------------------------------//\n        //----------- DOM ELEMENTS ------------//\n        //-------------------------------------//\n\n        const gameContainer = document.getElementById('game-container');\n        const startScreen = document.getElementById('start-screen');\n        const winScreen = document.getElementById('win-screen');\n        const startButton = document.getElementById('start-button');\n        const restartButton = document.getElementById('restart-button');\n        const progressBar = document.getElementById('progress-bar');\n        const mainCanvas = document.getElementById('main-canvas');\n        const rocketElem = document.getElementById('rocket');\n        const questionPanel = document.getElementById('question-panel');\n        const mascotElem = document.getElementById('mascot');\n        const questionText = document.getElementById('question-text');\n        const interactionArea = document.getElementById('interaction-area');\n        const hintBox = document.getElementById('hint-box');\n\n        //-------------------------------------//\n        //----------- SVG CLONING -------------//\n        //-------------------------------------//\n        \n        const getSVG = (id) => document.getElementById(id).cloneNode(true);\n\n        rocketElem.appendChild(getSVG('svg-rocket'));\n        mascotElem.appendChild(getSVG('svg-bolt'));\n        \n        //-------------------------------------//\n        //----------- SOUND ENGINE ------------//\n        //-------------------------------------//\n        \n        let audioCtx;\n        function initAudio() {\n            if (!audioCtx) {\n                audioCtx = new (window.AudioContext || window.webkitAudioContext)();\n            }\n        }\n\n        function playSound(type) {\n            if (!audioCtx) return;\n            const oscillator = audioCtx.createOscillator();\n            const gainNode = audioCtx.createGain();\n            oscillator.connect(gainNode);\n            gainNode.connect(audioCtx.destination);\n            gainNode.gain.setValueAtTime(0.1, audioCtx.currentTime);\n\n            if (type === 'correct') {\n                oscillator.type = 'sine';\n                oscillator.frequency.setValueAtTime(440, audioCtx.currentTime); // A4\n                gainNode.gain.exponentialRampToValueAtTime(0.00001, audioCtx.currentTime + 0.5);\n                oscillator.frequency.exponentialRampToValueAtTime(880, audioCtx.currentTime + 0.5); // A5\n            } else if (type === 'incorrect') {\n                oscillator.type = 'square';\n                oscillator.frequency.setValueAtTime(150, audioCtx.currentTime);\n                gainNode.gain.exponentialRampToValueAtTime(0.00001, audioCtx.currentTime + 0.3);\n            } else if (type === 'whoosh') {\n                 oscillator.type = 'white-noise';\n                 gainNode.gain.exponentialRampToValueAtTime(0.00001, audioCtx.currentTime + 1.5);\n            }\n\n            oscillator.start(audioCtx.currentTime);\n            oscillator.stop(audioCtx.currentTime + 1.5);\n        }\n\n        //-------------------------------------//\n        //---------- GAME FLOW & LOGIC --------//\n        //-------------------------------------//\n\n        function initGame() {\n            // Reset state\n            gameState.currentLevel = 0;\n            gameState.score = 0;\n\n            // Setup UI\n            startScreen.classList.remove('hidden');\n            winScreen.classList.add('hidden');\n            questionPanel.classList.add('hidden');\n            interactionArea.innerHTML = '';\n            \n            // Build progress bar\n            progressBar.innerHTML = '';\n            gameState.planetPositions.forEach((planet, index) => {\n                const stop = document.createElement('div');\n                stop.className = 'planet-stop';\n                stop.dataset.planet = planet.name;\n                \n                const planetSVG = getSVG(`svg-${planet.name.toLowerCase()}`);\n                stop.appendChild(planetSVG);\n                \n                const name = document.createElement('span');\n                name.textContent = planet.name;\n                stop.appendChild(name);\n                \n                progressBar.appendChild(stop);\n\n                if (index < gameState.planetPositions.length - 1) {\n                    const line = document.createElement('div');\n                    line.className = 'progress-line';\n                    progressBar.appendChild(line);\n                }\n            });\n\n            // Reset rocket position\n            const initialPos = gameState.planetPositions[0];\n            rocketElem.style.left = initialPos.left;\n            rocketElem.style.top = initialPos.top;\n            rocketElem.style.transform = 'translateY(-50%)';\n            \n            mainCanvas.querySelectorAll('.planet-bg').forEach(p => p.remove());\n\n            // Add event listeners\n            startButton.onclick = startGame;\n            restartButton.onclick = initGame;\n        }\n\n        function startGame() {\n            initAudio(); // Initialize audio on first user interaction\n            startScreen.classList.add('hidden');\n            renderLevel(gameState.currentLevel);\n        }\n\n        function renderLevel(levelIndex) {\n            const level = gameState.levelData[levelIndex];\n            gameState.attempts = 0;\n            hintBox.style.display = 'none';\n\n            // Update Progress Bar\n            progressBar.querySelectorAll('.planet-stop').forEach(stop => {\n                stop.classList.remove('active');\n                if (stop.dataset.planet === level.planet) {\n                    stop.classList.add('active');\n                }\n            });\n\n            // Update planet background\n            mainCanvas.querySelectorAll('.planet-bg').forEach(p => p.classList.remove('visible'));\n            let planetBg = mainCanvas.querySelector(`#planet-bg-${level.planet}`);\n            if (!planetBg) {\n                planetBg = document.createElement('div');\n                planetBg.id = `planet-bg-${level.planet}`;\n                planetBg.className = 'planet-bg';\n                planetBg.appendChild(getSVG(`svg-${level.planet.toLowerCase()}`));\n                mainCanvas.appendChild(planetBg);\n            }\n            setTimeout(() => planetBg.classList.add('visible'), 100);\n\n            // Update question panel\n            questionPanel.classList.remove('hidden');\n            questionPanel.classList.remove('shake');\n            questionText.innerHTML = level.question;\n\n            // Setup interaction area\n            interactionArea.innerHTML = '';\n            level.setup();\n\n            // Setup submit button\n            const submitButton = document.createElement('button');\n            submitButton.id = 'submit-button';\n            submitButton.className = 'game-button';\n            submitButton.textContent = level.interaction === 'keypad' ? 'Transmit' : 'Check';\n            submitButton.onclick = () => checkAnswer(levelIndex);\n            interactionArea.appendChild(submitButton);\n        }\n\n        function checkAnswer(levelIndex) {\n            const level = gameState.levelData[levelIndex];\n            const isCorrect = level.check();\n\n            if (isCorrect) {\n                playSound('correct');\n                mascotElem.style.transform = 'rotate(10deg)';\n                setTimeout(()=> mascotElem.style.transform = 'rotate(0deg)', 300);\n                \n                // Update score\n                if (gameState.attempts === 0) gameState.score += 100;\n                else if (gameState.attempts === 1) gameState.score += 50;\n                else gameState.score += 25;\n\n                advanceLevel();\n            } else {\n                playSound('incorrect');\n                gameState.attempts++;\n                questionPanel.classList.add('shake');\n                setTimeout(() => questionPanel.classList.remove('shake'), 500);\n\n                if (gameState.attempts >= 2) {\n                    showHint(level.hint);\n                }\n            }\n        }\n        \n        function showHint(hintText) {\n            hintBox.textContent = hintText;\n            hintBox.style.display = 'block';\n        }\n\n        function advanceLevel() {\n            questionPanel.classList.add('hidden');\n            interactionArea.innerHTML = '';\n            playSound('whoosh');\n\n            gameState.currentLevel++;\n            \n            const nextPos = gameState.planetPositions[gameState.currentLevel];\n            rocketElem.style.left = nextPos.left;\n            rocketElem.style.top = nextPos.top;\n\n            setTimeout(() => {\n                if (gameState.currentLevel < gameState.levelData.length) {\n                    renderLevel(gameState.currentLevel);\n                } else {\n                    showWinScreen();\n                }\n            }, 1800); // Wait for rocket animation to finish\n        }\n\n        function showWinScreen() {\n            // Final rocket move to Neptune\n            const neptunePos = gameState.planetPositions[gameState.planetPositions.length - 1];\n            \n            // Highlight Neptune on progress bar\n            progressBar.querySelectorAll('.planet-stop').forEach(stop => {\n                stop.classList.remove('active');\n                if (stop.dataset.planet === 'Neptune') {\n                    stop.classList.add('active');\n                }\n            });\n            \n            // Show Neptune background\n            mainCanvas.querySelectorAll('.planet-bg').forEach(p => p.classList.remove('visible'));\n            let planetBg = mainCanvas.querySelector('#planet-bg-Neptune');\n            if (!planetBg) {\n                planetBg = document.createElement('div');\n                planetBg.id = `planet-bg-Neptune`;\n                planetBg.className = 'planet-bg visible';\n                planetBg.appendChild(getSVG('svg-neptune'));\n                mainCanvas.appendChild(planetBg);\n            }\n            planetBg.classList.add('visible');\n            \n            // Show win screen\n            document.getElementById('final-score').textContent = `Total Data Points: ${gameState.score}`;\n            winScreen.classList.remove('hidden');\n        }\n\n        //-------------------------------------//\n        //------ LEVEL-SPECIFIC SETUPS --------//\n        //-------------------------------------//\n\n        // --- LEVEL 1: DRAG & DROP ---\n        let droppedFuelCount = 0;\n        function setupLevel1() {\n            droppedFuelCount = 0;\n            const launchpad = document.createElement('div');\n            launchpad.id = 'launchpad';\n            launchpad.style.cssText = `\n                width: 150px; height: 150px; border: 3px dashed var(--glow-yellow); \n                border-radius: 10px; display: flex; align-items: center; \n                justify-content: center; font-size: 2rem; color: var(--glow-yellow);\n            `;\n            launchpad.textContent = '0 / 8';\n            \n            launchpad.ondragover = (e) => e.preventDefault();\n            launchpad.ondrop = (e) => {\n                e.preventDefault();\n                const count = parseInt(e.dataTransfer.getData('text/plain'), 10);\n                droppedFuelCount += count;\n                launchpad.textContent = `${droppedFuelCount} / 8`;\n                launchpad.style.background = 'rgba(57, 255, 20, 0.2)';\n                setTimeout(() => launchpad.style.background = 'transparent', 200);\n            };\n\n            const fuelTray = document.createElement('div');\n            fuelTray.id = 'fuel-tray';\n            [5, 8, 10].forEach(count => {\n                const pile = document.createElement('div');\n                pile.className = 'fuel-pile';\n                pile.draggable = true;\n                pile.dataset.count = count;\n                pile.innerHTML = `<span>${count} Fuel Cells</span>`;\n                pile.appendChild(getSVG('svg-fuel'));\n                \n                pile.ondragstart = (e) => {\n                    e.dataTransfer.setData('text/plain', pile.dataset.count);\n                    e.target.style.opacity = '0.5';\n                };\n                pile.ondragend = (e) => e.target.style.opacity = '1';\n                fuelTray.appendChild(pile);\n            });\n            \n            interactionArea.appendChild(launchpad);\n            interactionArea.appendChild(fuelTray);\n        }\n\n        function checkLevel1() {\n            return droppedFuelCount === gameState.levelData[0].answer;\n        }\n\n        // --- LEVEL 2: KEYPAD ---\n        function setupLevel2() {\n            const container = document.createElement('div');\n            container.id = 'keypad-container';\n            \n            const display = document.createElement('div');\n            display.id = 'datapad-display';\n            \n            const keypad = document.createElement('div');\n            keypad.id = 'keypad';\n            \n            for (let i = 1; i <= 9; i++) keypad.appendChild(createKey(i));\n            keypad.appendChild(createKey('C'));\n            keypad.appendChild(createKey(0));\n            keypad.appendChild(createKey('⌫'));\n            \n            container.appendChild(display);\n            container.appendChild(keypad);\n            interactionArea.insertBefore(container, interactionArea.firstChild);\n        }\n\n        function createKey(val) {\n            const btn = document.createElement('button');\n            btn.className = 'keypad-btn';\n            btn.textContent = val;\n            btn.onclick = () => {\n                const display = document.getElementById('datapad-display');\n                if (val === 'C') {\n                    display.textContent = '';\n                } else if (val === '⌫') {\n                    display.textContent = display.textContent.slice(0, -1);\n                } else if (display.textContent.length < 3) {\n                    display.textContent += val;\n                }\n            };\n            return btn;\n        }\n\n        function checkLevel2() {\n            const display = document.getElementById('datapad-display');\n            return parseInt(display.textContent, 10) === gameState.levelData[1].answer;\n        }\n\n        // --- LEVEL 3: CHOICE ---\n        let selectedChoice = null;\n        function setupLevel3() {\n            selectedChoice = null;\n            const container = document.createElement('div');\n            container.id = 'lab-container';\n            \n            // Create lab boxes\n            for(let i=0; i<3; i++){\n                const lab = document.createElement('div');\n                lab.className = 'lab-box';\n                lab.id = `lab-box-${i}`;\n                lab.textContent = '?';\n                container.appendChild(lab);\n            }\n            \n            // Create answer choices\n            const choicesDiv = document.createElement('div');\n            choicesDiv.id = 'answer-choices';\n            [4, 5, 3].forEach(num => {\n                const btn = document.createElement('button');\n                btn.className = 'choice-btn';\n                btn.textContent = num;\n                btn.dataset.value = num;\n                btn.onclick = () => {\n                    selectedChoice = num;\n                    // Update lab boxes visually\n                    document.querySelectorAll('.lab-box').forEach(box => box.textContent = num);\n                    // Update button style\n                    choicesDiv.querySelectorAll('.choice-btn').forEach(b => b.classList.remove('selected'));\n                    btn.classList.add('selected');\n                };\n                choicesDiv.appendChild(btn);\n            });\n            \n            container.appendChild(choicesDiv);\n            interactionArea.insertBefore(container, interactionArea.firstChild);\n        }\n\n        function checkLevel3() {\n            return selectedChoice === gameState.levelData[2].answer;\n        }\n\n        //-------------------------------------//\n        //--------- INITIALIZE GAME -----------//\n        //-------------------------------------//\n        initGame();\n    });\n    </script>\n</body>\n</html>